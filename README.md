# Avito Monitor

## Назначение
С помощью этого монитора вы можете получать оповещения о появлении новых товаров по указанной ссылке на Авито. При появлении нового товара посылается сообщение через discord webhook или через telegram-бота

## Настройка
Первым делом создайте в папке с проектом или рядом с exe-шником файл `.env`. В нем нужно указать ссылку на страницу, которая будет мониториться, задержку после каждой итерации, а также id и token вебхука

```dotenv
LINKS="https://www.avito.ru/volgograd/hobbi_i_otdyh https://www.avito.ru/belgorod/tovary_dlya_kompyutera"
DELAY=10000

BOT_SOURCE=DISCORD
WEBHOOK_ID=12345678
WEBHOOK_TOKEN=1q2w3e4r5t6y
```

Если вы хотите получать уведомления в телеграме, то вам придется создать своего бота и указать его токен

```dotenv
BOT_SOURCE=TELEGRAM
TELEGRAM_TOKEN=q1w2e3r4t5y6
```

Для начала работы в боте надо будет вызвать команду `/start` (после запуска этого монитора). Id чата будет сохранен в файл `./db/chat-ids.db` и будет использоваться для рассылки. Количество чатов неограниченно

Оповещения отправляются по дефолту при обновлении информации о товаре, и при появлении новых лотов. Это можно контролировать с помощью данных строчек в `.env` файле

```dotenv
MESSAGE_ON_CHANGE=false
MESSAGE_ON_NEW=true
```

Кроме того, вы можете использовать прокси. Для этого укажите пусть к файлу, в котором они записаны в формате `ip:port`. Путь указывается относительно корня проекта

```dotenv
PROXY=./db/proxy.db
```

## Запуск
Вы можете воспользоваться exe файлом, который находится в релизах, или сделать его самостоятельно командой `npm run exe`

Можно запустить монитор и просто через команду `npm run start`

Для работы с автоматическим перезапуском выполните `npm run watch`. 

> **Осторожно!** При неправильных действиях бот будет работать в фоновом режиме и выключить его можно будет только через диспетчер задач. Кроме того, вы можете нечаянно запустить сразу несколько мониторов и получить бан на свой ip 

